<div class="cwikmeta">  
{  
"title": "Blockchain Voting Techniques"  
} </div>
<h1 id="blockchain-voting-techniques"><a href="blockchain-voting-techniques">Blockchain Voting Techniques</a></h1>
<h2 id="a-blockchain-as-a-public-record">A Blockchain as a public record</h2>
<ul>
<li>Permanent public record of vote</li>
<li>Allows permissionless, independent and potentially open source vote tallies</li>
<li>Orders repeat votes (allowing unambiguous discarding of one), or prevents repeats</li>
<li>Provides registration &amp; communication mechanism</li>
<li>Public record of number of registrations &amp; participants</li>
<li>Blockchains cannot stand alone as the voter registration authority (Sybil attack)<sup>1</sup></li>
</ul>
<p>A blockchain represents a public commitment of ordered data.  This data repository can be used to record votes in a variety of ways.  Any interested party can access the blockchain to discover all votes, so long as they know how to differentiate votes from other blockchain activity.</p>
<p>Note that blockchain reorganizations or mining denial-of-service attacks can be used to remove or ignore transactions and therefore votes, preventing their inclusion in the blockchain’s main chain.  But these attacks cannot be used to change a participant’s vote.</p>
<p>These attacks could affect an election that specifies a moment in time when polls close.  However, reorganizations leave strong historical evidence of misbehavior in terms of proof-of-work, and denial-of-service attacks leave strong cotemporal evidence (e.g. any participant actively monitoring the network during the voting will see vote records posted to the network but not included in the blockchain).</p>
<h2 id="blockchain-vote-recording-techniques">Blockchain Vote Recording Techniques</h2>
<ul>
<li>Data Carried: Encoded as data in an arbitrary, otherwise unrelated transaction</li>
<li>Token: A token payment to a choice of destinations, each destination represents one choice.</li>
<li>A hybrid where a token represents permission-to-vote, but the actual vote is data carried in a transaction the melts or returns the token to the voting authority.</li>
</ul>
<h3 id="vote-via-data-carrying">Vote Via Data Carrying</h3>
<p>One construction<sup>6</sup> of a data carrying vote allows any entity to construct an arbitrary transaction that sends to a specific output contract.  Spending this output in a new transaction is the act of voting.  To satisfy the contract, the voter must push a public key P registered by the voting authority, a signature of the transaction using P, vote identifier and choice data, and the signature of that data using P.</p>
<p>The use of data signatures (BCH’s OP_CHECKDATASIGVERIFY) allows the vote to be safely placed in the transaction’s satisfier script (also called scriptSig) even though the satisfier script is not signed as part of the transaction’s signature.</p>
<h2 id="merkle-tally-tree">Merkle Tally Tree</h2>
<p><em>tallies votes in a manner that admits succinct inclusion proofs</em></p>
<ul>
<li>Merkle inclusion proof can prove that a particular vote was counted in O(log N) data</li>
<li>But cannot prove no “ballot stuffing”</li>
</ul>
<p>Extend a normal merkle tree at each node N with vote tallies of the sum of all the votes in the subtree rooted at N.  The node hashes must concatenate the child hashes as in a normal Merkle tree and the vote tallies to ensure that the tallies cannot be modified without forcing the higher Merkle node hashes to change.  The merkle tree root therefore contains the election results.</p>
<p>Providing a more formal construction:</p>
<p>Assume a vote with different yes/no decisions <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">D_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.55em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, functions LeftChild and RightChild that return Merkle tree children, H is a cryptographic hash function, and the operator “|” is byte string concatenation:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>T</mi><mi>a</mi><mi>l</mi><mi>l</mi><mi>y</mi><mo stretchy="false">(</mo><mi>N</mi><mo separator="true">,</mo><msub><mi>D</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>T</mi><mi>a</mi><mi>l</mi><mi>l</mi><mi>y</mi><mo stretchy="false">(</mo><mi>L</mi><mi>e</mi><mi>f</mi><mi>t</mi><mi>C</mi><mi>h</mi><mi>i</mi><mi>l</mi><mi>d</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi><msub><mi>D</mi><mi>i</mi></msub><mo>+</mo><mi>R</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>C</mi><mi>h</mi><mi>i</mi><mi>l</mi><mi>d</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi><msub><mi>D</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
Tally(N, D_i)= Tally(LeftChild(N).D_i + RightChild(N).D_i)  \tag1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.166667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em"><span style="top:-2.55em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.277778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mclose">)</span><span class="mord">.</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em"><span style="top:-2.55em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mclose">)</span><span class="mord">.</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em"><span style="top:-2.55em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span></span><span class="mord">)</span></span></span></span></span></span></span></p>
<p>Merkle Node hash calculation:<br />
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>T</mi><mi>a</mi><mi>l</mi><mi>l</mi><mi>y</mi><mo stretchy="false">(</mo><mi>N</mi><mo separator="true">,</mo><msub><mi>D</mi><mi>x</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mi>H</mi><mo stretchy="false">(</mo><mi>L</mi><mi>e</mi><mi>f</mi><mi>t</mi><mi>C</mi><mi>h</mi><mi>i</mi><mi>l</mi><mi>d</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mi>H</mi><mo stretchy="false">(</mo><mi>R</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>C</mi><mi>h</mi><mi>i</mi><mi>l</mi><mi>d</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
H(N) = H(Tally(N, D_x)) | H(LeftChild(N)) | H(RightChild(N))  \tag2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.277778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.166667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.55em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em">R</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mclose">)</span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span></span></p>
<p>The merkle tree leaf nodes are the hash of a vote, and participant information (such as the blockchain transaction or transaction hash, public key &amp; signature) P, that proves the validity of the vote:<br />
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>T</mi><mi>a</mi><mi>l</mi><mi>l</mi><mi>y</mi><mo stretchy="false">(</mo><mi>P</mi><mo separator="true">,</mo><msub><mi>D</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext mathvariant="monospace">1 if vote "yes" for decision D_i</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext mathvariant="monospace">0 otherwise</mtext></mstyle></mtd></mtr></mtable></mrow></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(3)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
Tally(P, D_i) = \left\{ \begin{array}{l}
     \verb|1 if vote "yes" for decision D_i| \\
     \verb|0 otherwise|
 \end{array} \right. \tag3
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.166667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em"><span style="top:-2.55em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.277778em"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em"><span style="top:-3.61em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord texttt">1 if vote "yes" for decision D_i</span></span></span></span><span style="top:-2.41em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord text"><span class="mord texttt">0 otherwise</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em"></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="tag"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">3</span></span><span class="mord">)</span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>V</mi><mi>n</mi></msub><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>T</mi><mi>a</mi><mi>l</mi><mi>l</mi><mi>y</mi><mo stretchy="false">(</mo><mi>P</mi><mo separator="true">,</mo><msub><mi>D</mi><mi>x</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mi>P</mi><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(4)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
V_n = H(Tally(P,D_x) | P) \tag4
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.55em;margin-left:-0.22222em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.277778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.277778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.166667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em"><span style="top:-2.55em;margin-left:-0.02778em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">4</span></span><span class="mord">)</span></span></span></span></span></span></span></p>
<p>The following diagram illustrates the merkle tree of votes.  Vote tallies appear in brackets.  For brevity, tallies have been omitted from many nodes, except those that are part of the merkle proof of vote <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">V_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em"><span style="top:-2.55em;margin-left:-0.22222em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, which is indicated in light blue.</p>
<div><svg id="mer0" width="979.6312866210938" xmlns="http://www.w3.org/2000/svg" height="519.3968811035156" viewbox="0 0 979.6312866210938 519.3968811035156"><style>#mer0 .label{font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family);color:#333}#mer0 .label text{fill:#333}#mer0 .node rect,#mer0 .node circle,#mer0 .node ellipse,#mer0 .node polygon,#mer0 .node path{fill:#ECECFF;stroke:#9370db;stroke-width:1px}#mer0 .node .label{text-align:center}#mer0 .node.clickable{cursor:pointer}#mer0 .arrowheadPath{fill:#333}#mer0 .edgePath .path{stroke:#333;stroke-width:1.5px}#mer0 .edgeLabel{background-color:#e8e8e8;text-align:center}#mer0 .edgeLabel rect{opacity:0.5}#mer0 .cluster rect{fill:#ffffde;stroke:#aa3;stroke-width:1px}#mer0 .cluster text{fill:#333}#mer0 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family);font-size:12px;background:#ffffde;border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}#mer0 .actor{stroke:#ccf;fill:#ECECFF}#mer0 text.actor{fill:#000;stroke:none}#mer0 .actor-line{stroke:grey}#mer0 .messageLine0{stroke-width:1.5;stroke-dasharray:'2 2';stroke:#333}#mer0 .messageLine1{stroke-width:1.5;stroke-dasharray:'2 2';stroke:#333}#mer0 #arrowhead{fill:#333}#mer0 .sequenceNumber{fill:#fff}#mer0 #sequencenumber{fill:#333}#mer0 #crosshead path{fill:#333 !important;stroke:#333 !important}#mer0 .messageText{fill:#333;stroke:none}#mer0 .labelBox{stroke:#ccf;fill:#ECECFF}#mer0 .labelText{fill:#000;stroke:none}#mer0 .loopText{fill:#000;stroke:none}#mer0 .loopLine{stroke-width:2;stroke-dasharray:'2 2';stroke:#ccf}#mer0 .note{stroke:#aa3;fill:#fff5ad}#mer0 .noteText{fill:black;stroke:none;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family);font-size:14px}#mer0 .activation0{fill:#f4f4f4;stroke:#666}#mer0 .activation1{fill:#f4f4f4;stroke:#666}#mer0 .activation2{fill:#f4f4f4;stroke:#666}#mer0 .mermaid-main-font{font-family:"trebuchet ms", verdana, arial;font-family:var(--mermaid-font-family)}#mer0 .section{stroke:none;opacity:0.2}#mer0 .section0{fill:rgba(102,102,255,0.49)}#mer0 .section2{fill:#fff400}#mer0 .section1,#mer0 .section3{fill:#fff;opacity:0.2}#mer0 .sectionTitle0{fill:#333}#mer0 .sectionTitle1{fill:#333}#mer0 .sectionTitle2{fill:#333}#mer0 .sectionTitle3{fill:#333}#mer0 .sectionTitle{text-anchor:start;font-size:11px;text-height:14px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mer0 .grid .tick{stroke:#d3d3d3;opacity:0.8;shape-rendering:crispEdges}#mer0 .grid .tick text{font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mer0 .grid path{stroke-width:0}#mer0 .today{fill:none;stroke:red;stroke-width:2px}#mer0 .task{stroke-width:2}#mer0 .taskText{text-anchor:middle;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mer0 .taskText:not([font-size]){font-size:11px}#mer0 .taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mer0 .taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}#mer0 .task.clickable{cursor:pointer}#mer0 .taskText.clickable{cursor:pointer;fill:#003163 !important;font-weight:bold}#mer0 .taskTextOutsideLeft.clickable{cursor:pointer;fill:#003163 !important;font-weight:bold}#mer0 .taskTextOutsideRight.clickable{cursor:pointer;fill:#003163 !important;font-weight:bold}#mer0 .taskText0,#mer0 .taskText1,#mer0 .taskText2,#mer0 .taskText3{fill:#fff}#mer0 .task0,#mer0 .task1,#mer0 .task2,#mer0 .task3{fill:#8a90dd;stroke:#534fbc}#mer0 .taskTextOutside0,#mer0 .taskTextOutside2{fill:#000}#mer0 .taskTextOutside1,#mer0 .taskTextOutside3{fill:#000}#mer0 .active0,#mer0 .active1,#mer0 .active2,#mer0 .active3{fill:#bfc7ff;stroke:#534fbc}#mer0 .activeText0,#mer0 .activeText1,#mer0 .activeText2,#mer0 .activeText3{fill:#000 !important}#mer0 .done0,#mer0 .done1,#mer0 .done2,#mer0 .done3{stroke:grey;fill:#d3d3d3;stroke-width:2}#mer0 .doneText0,#mer0 .doneText1,#mer0 .doneText2,#mer0 .doneText3{fill:#000 !important}#mer0 .crit0,#mer0 .crit1,#mer0 .crit2,#mer0 .crit3{stroke:#f88;fill:red;stroke-width:2}#mer0 .activeCrit0,#mer0 .activeCrit1,#mer0 .activeCrit2,#mer0 .activeCrit3{stroke:#f88;fill:#bfc7ff;stroke-width:2}#mer0 .doneCrit0,#mer0 .doneCrit1,#mer0 .doneCrit2,#mer0 .doneCrit3{stroke:#f88;fill:#d3d3d3;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}#mer0 .milestone{transform:rotate(45deg) scale(0.8, 0.8)}#mer0 .milestoneText{font-style:italic}#mer0 .doneCritText0,#mer0 .doneCritText1,#mer0 .doneCritText2,#mer0 .doneCritText3{fill:#000 !important}#mer0 .activeCritText0,#mer0 .activeCritText1,#mer0 .activeCritText2,#mer0 .activeCritText3{fill:#000 !important}#mer0 .titleText{text-anchor:middle;font-size:18px;fill:#000;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mer0 g.classGroup text{fill:#9370db;stroke:none;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family);font-size:10px}#mer0 g.classGroup text .title{font-weight:bolder}#mer0 g.clickable{cursor:pointer}#mer0 g.classGroup rect{fill:#ECECFF;stroke:#9370db}#mer0 g.classGroup line{stroke:#9370db;stroke-width:1}#mer0 .classLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.5}#mer0 .classLabel .label{fill:#9370db;font-size:10px}#mer0 .relation{stroke:#9370db;stroke-width:1;fill:none}#mer0 .dashed-line{stroke-dasharray:3}#mer0 #compositionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mer0 #compositionEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mer0 #aggregationStart{fill:#ECECFF;stroke:#9370db;stroke-width:1}#mer0 #aggregationEnd{fill:#ECECFF;stroke:#9370db;stroke-width:1}#mer0 #dependencyStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mer0 #dependencyEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mer0 #extensionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mer0 #extensionEnd{fill:#9370db;stroke:#9370db;stroke-width:1}#mer0 .commit-id,#mer0 .commit-msg,#mer0 .branch-label{fill:lightgrey;color:lightgrey;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mer0 .pieTitleText{text-anchor:middle;font-size:25px;fill:#000;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mer0 .slice{font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mer0 g.stateGroup text{fill:#9370db;stroke:none;font-size:10px;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mer0 g.stateGroup text{fill:#9370db;stroke:none;font-size:10px}#mer0 g.stateGroup .state-title{font-weight:bolder;fill:#000}#mer0 g.stateGroup rect{fill:#ECECFF;stroke:#9370db}#mer0 g.stateGroup line{stroke:#9370db;stroke-width:1}#mer0 .transition{stroke:#9370db;stroke-width:1;fill:none}#mer0 .stateGroup .composit{fill:white;border-bottom:1px}#mer0 .stateGroup .alt-composit{fill:#e0e0e0;border-bottom:1px}#mer0 .state-note{stroke:#aa3;fill:#fff5ad}#mer0 .state-note text{fill:black;stroke:none;font-size:10px}#mer0 .stateLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.5}#mer0 .stateLabel text{fill:#000;font-size:10px;font-weight:bold;font-family:'trebuchet ms', verdana, arial;font-family:var(--mermaid-font-family)}#mer0 .node circle.state-start{fill:black;stroke:black}#mer0 .node circle.state-end{fill:black;stroke:white;stroke-width:1.5}#mer0 #statediagram-barbEnd{fill:#9370db}#mer0 .statediagram-cluster rect{fill:#ECECFF;stroke:#9370db;stroke-width:1px}#mer0 .statediagram-cluster rect.outer{rx:5px;ry:5px}#mer0 .statediagram-state .divider{stroke:#9370db}#mer0 .statediagram-state .title-state{rx:5px;ry:5px}#mer0 .statediagram-cluster.statediagram-cluster .inner{fill:white}#mer0 .statediagram-cluster.statediagram-cluster-alt .inner{fill:#e0e0e0}#mer0 .statediagram-cluster .inner{rx:0;ry:0}#mer0 .statediagram-state rect.basic{rx:5px;ry:5px}#mer0 .statediagram-state rect.divider{stroke-dasharray:10,10;fill:#efefef}#mer0 .note-edge{stroke-dasharray:5}#mer0 .statediagram-note rect{fill:#fff5ad;stroke:#aa3;stroke-width:1px;rx:0;ry:0}:root{--mermaid-font-family: '"trebuchet ms", verdana, arial';--mermaid-font-family: "Comic Sans MS", "Comic Sans", cursive}

:root { --mermaid-font-family: "trebuchet ms", verdana, arial;}
#mer0 .proof &gt; * { fill:#cff !important; stroke:#333 !important; stroke-width:3px !important; }
#mer0 .proof tspan {  !important; }</style><style>#mer0 {
    color: rgb(0, 0, 0);
    font: 16px "Times New Roman";
  }</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity:1"><path class="path" d="M448.9250030517578,35.791536778224604L243.30546951293945,80L243.30546951293945,114" marker-end="url(#arrowhead54)" style="fill:none"></path><defs><marker id="arrowhead54" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M530.7062530517578,35.11069528097772L757.0187530517578,80L757.0187530517578,114" marker-end="url(#arrowhead55)" style="fill:none"></path><defs><marker id="arrowhead55" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M212.64140701293945,144.56729080619988L102.8062515258789,186L102.8062515258789,220" marker-end="url(#arrowhead56)" style="fill:none"></path><defs><marker id="arrowhead56" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M273.96953201293945,145.82671821898933L370.0093765258789,186L370.0093765258789,220" marker-end="url(#arrowhead57)" style="fill:none"></path><defs><marker id="arrowhead57" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M726.3546905517578,146.56519623810237L637.2125015258789,186L637.2125015258789,220" marker-end="url(#arrowhead58)" style="fill:none"></path><defs><marker id="arrowhead58" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M787.6828155517578,146.56519623810237L876.8250045776367,186L876.8250045776367,220" marker-end="url(#arrowhead59)" style="fill:none"></path><defs><marker id="arrowhead59" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M81.33154606369307,258L42.90312576293945,292L42.90312576293945,326" marker-end="url(#arrowhead60)" style="fill:none"></path><defs><marker id="arrowhead60" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M124.28095698806474,258L162.70937728881836,292L162.70937728881836,326" marker-end="url(#arrowhead61)" style="fill:none"></path><defs><marker id="arrowhead61" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M343.5891822239138,258L296.31093978881836,292L296.31093978881836,326" marker-end="url(#arrowhead62)" style="fill:none"></path><defs><marker id="arrowhead62" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M396.42957082784403,258L443.70781326293945,292L443.70781326293945,326" marker-end="url(#arrowhead63)" style="fill:none"></path><defs><marker id="arrowhead63" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M622.7593765258789,251.78757352381626L577.3093757629395,292L577.3093757629395,326" marker-end="url(#arrowhead64)" style="fill:none"></path><defs><marker id="arrowhead64" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M651.6656265258789,251.78757352381626L697.1156272888184,292L697.1156272888184,326" marker-end="url(#arrowhead65)" style="fill:none"></path><defs><marker id="arrowhead65" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M861.0437545776367,252.96264784762639L816.9218788146973,292L816.9218788146973,326" marker-end="url(#arrowhead66)" style="fill:none"></path><defs><marker id="arrowhead66" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M892.6062545776367,252.96264784762639L936.7281303405762,292L936.7281303405762,326" marker-end="url(#arrowhead67)" style="fill:none"></path><defs><marker id="arrowhead67" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M42.90312576293945,364L42.90312576293945,389L43.40312576293945,428.2953117370605" marker-end="url(#arrowhead68)" style="fill:none"></path><defs><marker id="arrowhead68" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M162.70937728881836,364L162.70937728881836,389L163.20937728881833,428.2953117370608" marker-end="url(#arrowhead69)" style="fill:none"></path><defs><marker id="arrowhead69" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M296.31093978881836,364L296.31093978881836,389L296.8109397888182,414.50000076293946" marker-end="url(#arrowhead70)" style="fill:none"></path><defs><marker id="arrowhead70" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M443.70781326293945,364L443.70781326293945,389L444.2078132629397,414.50000076293935" marker-end="url(#arrowhead71)" style="fill:none"></path><defs><marker id="arrowhead71" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M577.3093757629395,364L577.3093757629395,389L577.8093757629396,428.29531173706005" marker-end="url(#arrowhead72)" style="fill:none"></path><defs><marker id="arrowhead72" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M697.1156272888184,364L697.1156272888184,389L697.615627288818,428.29531173705885" marker-end="url(#arrowhead73)" style="fill:none"></path><defs><marker id="arrowhead73" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M816.9218788146973,364L816.9218788146973,389L817.4218788146974,428.2953117370593" marker-end="url(#arrowhead74)" style="fill:none"></path><defs><marker id="arrowhead74" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g><g class="edgePath" style="opacity:1"><path class="path" d="M936.7281303405762,364L936.7281303405762,389L937.2281303405761,428.2953117370588" marker-end="url(#arrowhead75)" style="fill:none"></path><defs><marker id="arrowhead75" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width:1;stroke-dasharray:1, 0"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(243.30546951293945,80)" style="opacity:1"><g transform="translate(-4,-9)" class="label"><rect rx="0" ry="0" width="8" height="18" style="fill:#e8e8e8"></rect><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">0</span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(757.0187530517578,80)" style="opacity:1"><g transform="translate(-4,-9)" class="label"><rect rx="0" ry="0" width="8" height="18" style="fill:#e8e8e8"></rect><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">1</span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(102.8062515258789,186)" style="opacity:1"><g transform="translate(-4,-9)" class="label"><rect rx="0" ry="0" width="8" height="18" style="fill:#e8e8e8"></rect><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">0</span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(370.0093765258789,186)" style="opacity:1"><g transform="translate(-4,-9)" class="label"><rect rx="0" ry="0" width="8" height="18" style="fill:#e8e8e8"></rect><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">1</span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(637.2125015258789,186)" style="opacity:1"><g transform="translate(-4,-9)" class="label"><rect rx="0" ry="0" width="8" height="18" style="fill:#e8e8e8"></rect><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">0</span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(876.8250045776367,186)" style="opacity:1"><g transform="translate(-4,-9)" class="label"><rect rx="0" ry="0" width="8" height="18" style="fill:#e8e8e8"></rect><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">1</span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(42.90312576293945,292)" style="opacity:1"><g transform="translate(-4,-9)" class="label"><rect rx="0" ry="0" width="8" height="18" style="fill:#e8e8e8"></rect><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">0</span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(162.70937728881836,292)" style="opacity:1"><g transform="translate(-4,-9)" class="label"><rect rx="0" ry="0" width="8" height="18" style="fill:#e8e8e8"></rect><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">1</span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(296.31093978881836,292)" style="opacity:1"><g transform="translate(-4,-9)" class="label"><rect rx="0" ry="0" width="8" height="18" style="fill:#e8e8e8"></rect><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">0</span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(443.70781326293945,292)" style="opacity:1"><g transform="translate(-4,-9)" class="label"><rect rx="0" ry="0" width="8" height="18" style="fill:#e8e8e8"></rect><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">1</span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(577.3093757629395,292)" style="opacity:1"><g transform="translate(-4,-9)" class="label"><rect rx="0" ry="0" width="8" height="18" style="fill:#e8e8e8"></rect><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">0</span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(697.1156272888184,292)" style="opacity:1"><g transform="translate(-4,-9)" class="label"><rect rx="0" ry="0" width="8" height="18" style="fill:#e8e8e8"></rect><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">1</span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(816.9218788146973,292)" style="opacity:1"><g transform="translate(-4,-9)" class="label"><rect rx="0" ry="0" width="8" height="18" style="fill:#e8e8e8"></rect><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">0</span></div></foreignobject></g></g><g class="edgeLabel" transform="translate(936.7281303405762,292)" style="opacity:1"><g transform="translate(-4,-9)" class="label"><rect rx="0" ry="0" width="8" height="18" style="fill:#e8e8e8"></rect><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">1</span></div></foreignobject></g></g><g class="edgeLabel" transform style="opacity:1"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0" style="fill:#e8e8e8"></rect><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" transform style="opacity:1"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0" style="fill:#e8e8e8"></rect><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" transform style="opacity:1"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0" style="fill:#e8e8e8"></rect><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" transform style="opacity:1"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0" style="fill:#e8e8e8"></rect><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" transform style="opacity:1"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0" style="fill:#e8e8e8"></rect><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" transform style="opacity:1"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0" style="fill:#e8e8e8"></rect><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" transform style="opacity:1"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0" style="fill:#e8e8e8"></rect><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"></span></div></foreignobject></g></g><g class="edgeLabel" transform style="opacity:1"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0" style="fill:#e8e8e8"></rect><foreignobject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"></span></div></foreignobject></g></g></g><g class="nodes"><g class="node default" id="R" transform="translate(489.8156280517578,27)" style="opacity:1"><rect rx="5" ry="5" x="-40.890625" y="-19" width="81.78125" height="38" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-30.890625,-9)"><foreignobject width="61.78125" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Root[5,3]</div></foreignobject></g></g></g><g class="node default" id="B" transform="translate(243.30546951293945,133)" style="opacity:1"><rect rx="0" ry="0" x="-30.6640625" y="-19" width="61.328125" height="38" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-20.6640625,-9)"><foreignobject width="41.328125" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">B[3,1]</div></foreignobject></g></g></g><g class="node proof" id="C" transform="translate(757.0187530517578,133)" style="opacity:1"><rect rx="0" ry="0" x="-30.6640625" y="-19" width="61.328125" height="38" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-20.6640625,-9)"><foreignobject width="41.328125" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">C[2,2]</div></foreignobject></g></g></g><g class="node proof" id="D" transform="translate(102.8062515258789,239)" style="opacity:1"><rect rx="0" ry="0" x="-31.109375" y="-19" width="62.21875" height="38" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-21.109375,-9)"><foreignobject width="42.21875" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">D[2,0]</div></foreignobject></g></g></g><g class="node default" id="E" transform="translate(370.0093765258789,239)" style="opacity:1"><rect rx="0" ry="0" x="-30.21875" y="-19" width="60.4375" height="38" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-20.21875,-9)"><foreignobject width="40.4375" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">E[1,1]</div></foreignobject></g></g></g><g class="node default" id="F" transform="translate(637.2125015258789,239)" style="opacity:1"><rect rx="0" ry="0" x="-14.453125" y="-19" width="28.90625" height="38" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-4.453125,-9)"><foreignobject width="8.90625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">F</div></foreignobject></g></g></g><g class="node default" id="G" transform="translate(876.8250045776367,239)" style="opacity:1"><rect rx="0" ry="0" x="-15.78125" y="-19" width="31.5625" height="38" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-5.78125,-9)"><foreignobject width="11.5625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">G</div></foreignobject></g></g></g><g class="node default" id="H" transform="translate(42.90312576293945,345)" style="opacity:1"><rect rx="0" ry="0" x="-15.78125" y="-19" width="31.5625" height="38" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-5.78125,-9)"><foreignobject width="11.5625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">H</div></foreignobject></g></g></g><g class="node default" id="I" transform="translate(162.70937728881836,345)" style="opacity:1"><rect rx="0" ry="0" x="-12.6640625" y="-19" width="25.328125" height="38" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-2.6640625,-9)"><foreignobject width="5.328125" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">I</div></foreignobject></g></g></g><g class="node default" id="J" transform="translate(296.31093978881836,345)" style="opacity:1"><rect rx="0" ry="0" x="-28.4453125" y="-19" width="56.890625" height="38" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-18.4453125,-9)"><foreignobject width="36.890625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">J[1,0]</div></foreignobject></g></g></g><g class="node proof" id="K" transform="translate(443.70781326293945,345)" style="opacity:1"><rect rx="0" ry="0" x="-31.109375" y="-19" width="62.21875" height="38" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-21.109375,-9)"><foreignobject width="42.21875" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">K[0,1]</div></foreignobject></g></g></g><g class="node default" id="L" transform="translate(577.3093757629395,345)" style="opacity:1"><rect rx="0" ry="0" x="-14.890625" y="-19" width="29.78125" height="38" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-4.890625,-9)"><foreignobject width="9.78125" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">L</div></foreignobject></g></g></g><g class="node default" id="M" transform="translate(697.1156272888184,345)" style="opacity:1"><rect rx="0" ry="0" x="-17.1171875" y="-19" width="34.234375" height="38" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-7.1171875,-9)"><foreignobject width="14.234375" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">M</div></foreignobject></g></g></g><g class="node default" id="N" transform="translate(816.9218788146973,345)" style="opacity:1"><rect rx="0" ry="0" x="-15.78125" y="-19" width="31.5625" height="38" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-5.78125,-9)"><foreignobject width="11.5625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">N</div></foreignobject></g></g></g><g class="node default" id="O" transform="translate(936.7281303405762,345)" style="opacity:1"><rect rx="0" ry="0" x="-15.78125" y="-19" width="31.5625" height="38" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-5.78125,-9)"><foreignobject width="11.5625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">O</div></foreignobject></g></g></g><g class="node default" id="V0" transform="translate(42.90312576293945,462.69843673706055)" style="opacity:1"><polygon points="34.903125,0 69.80625,-34.903125 34.903125,-69.80625 0,-34.903125" transform="translate(-34.903125,34.903125)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-9.78125,-9)"><foreignobject width="19.5625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">V0</div></foreignobject></g></g></g><g class="node default" id="V1" transform="translate(162.70937728881836,462.69843673706055)" style="opacity:1"><polygon points="34.903125,0 69.80625,-34.903125 34.903125,-69.80625 0,-34.903125" transform="translate(-34.903125,34.903125)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-9.78125,-9)"><foreignobject width="19.5625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">V1</div></foreignobject></g></g></g><g class="node proof" id="V2" transform="translate(296.31093978881836,462.69843673706055)" style="opacity:1"><polygon points="48.698437500000004,0 97.39687500000001,-48.698437500000004 48.698437500000004,-97.39687500000001 0,-48.698437500000004" transform="translate(-48.698437500000004,48.698437500000004)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-25.109375,-9)"><foreignobject width="50.21875" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">V2[1,0]</div></foreignobject></g></g></g><g class="node default" id="V3" transform="translate(443.70781326293945,462.69843673706055)" style="opacity:1"><polygon points="48.698437500000004,0 97.39687500000001,-48.698437500000004 48.698437500000004,-97.39687500000001 0,-48.698437500000004" transform="translate(-48.698437500000004,48.698437500000004)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-25.109375,-9)"><foreignobject width="50.21875" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">V3[0,1]</div></foreignobject></g></g></g><g class="node default" id="V4" transform="translate(577.3093757629395,462.69843673706055)" style="opacity:1"><polygon points="34.903125,0 69.80625,-34.903125 34.903125,-69.80625 0,-34.903125" transform="translate(-34.903125,34.903125)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-9.78125,-9)"><foreignobject width="19.5625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">V4</div></foreignobject></g></g></g><g class="node default" id="V5" transform="translate(697.1156272888184,462.69843673706055)" style="opacity:1"><polygon points="34.903125,0 69.80625,-34.903125 34.903125,-69.80625 0,-34.903125" transform="translate(-34.903125,34.903125)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-9.78125,-9)"><foreignobject width="19.5625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">V5</div></foreignobject></g></g></g><g class="node default" id="V6" transform="translate(816.9218788146973,462.69843673706055)" style="opacity:1"><polygon points="34.903125,0 69.80625,-34.903125 34.903125,-69.80625 0,-34.903125" transform="translate(-34.903125,34.903125)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-9.78125,-9)"><foreignobject width="19.5625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">V6</div></foreignobject></g></g></g><g class="node default" id="V7" transform="translate(936.7281303405762,462.69843673706055)" style="opacity:1"><polygon points="34.903125,0 69.80625,-34.903125 34.903125,-69.80625 0,-34.903125" transform="translate(-34.903125,34.903125)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-9.78125,-9)"><foreignobject width="19.5625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">V7</div></foreignobject></g></g></g></g></g></g></svg></div>
<p>So the Merkle proof is “<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mn>2</mn></msub><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">V_2[1,0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em"><span style="top:-2.55em;margin-left:-0.22222em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.166667em"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span></span>, K[0,1], D[2,0], and C[2,2] at index 2”.</p>
<p>As with normal Merkle trees, specifying index 2 is required to communicate the data concatenation order at each level.  To explain, note that the Merkle proof execution for the provided example begins as follows:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>x</mi><mo>←</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>V</mi><mn>2</mn></msub><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(a1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
 x \leftarrow H(V_2[1,0])  \tag{a1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.277778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.277778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em"><span style="top:-2.55em;margin-left:-0.22222em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.166667em"></span><span class="mord">0</span><span class="mclose">]</span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">a</span><span class="mord">1</span></span><span class="mord">)</span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>x</mi><mo>←</mo><mi>H</mi><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∣</mi><mi>K</mi><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(a2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
x \leftarrow H(x | K[0,1])  \tag{a2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.277778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.277778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.166667em"></span><span class="mord">1</span><span class="mclose">]</span><span class="mclose">)</span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">a</span><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>x</mi><mo>←</mo><mi>H</mi><mo stretchy="false">(</mo><mi>D</mi><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(a3)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">
x \leftarrow H(D[2,0] | x), ... \tag{a3}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.277778em"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.277778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.166667em"></span><span class="mord">0</span><span class="mclose">]</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.166667em"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">a</span><span class="mord">3</span></span><span class="mord">)</span></span></span></span></span></span></span><br />
But how did the algorithm “know” to switch the order of concatenation in the last operation?  The answer is by using the element index.</p>
<p>To explain, note that the path from the root to child nodes are labelled with a 0 or 1.  Traversing any path and interpreting these a bits in a number results in the zero based element index of the vote in the tree, in this case its index 2 or 010 binary.  Starting with the least significant bit, use each bit to communicate to the prover the concatenation order (e.g. H(current val, next) or H(next, current val)) of the hash at each tree level, ignoring the bottom-most level which does not concatenate any elements.  For example the 2nd hash operation (a2, combining J and K) executes H(current value J | K[0,1]) because the first bit is 0, but the 3rd hash operation (a3, combining D and E) executes H( D[2,0] | current value E)  – note the different order – because the next bit in the index is a 1.  Therefore the index number of the merkle leaf communicates the prover in what order the proof elements must be combined.</p>
<p>An incorrectly specified index would result in the prover hashing data in the wrong order, yielding a different merkle root and therefore a failed merkle proof.   So a correct merkle proof also proves a vote’s position in the tree.</p>
<p>Actually, this additional index data can be eliminated if the hash function is commutative<sup>5</sup>, if there is no other use for it.  A simple commutative hash function CH based on cryptographic hash H is CH(x,y) = H(sort(x,y))</p>
<h2 id="tokens">Tokens</h2>
<ul>
<li>Issued 1 to each voter by the registration authority</li>
<li>Confers permission to participate in a vote.  Each token allows exactly 1 vote, enforced by blockchain token semantics</li>
</ul>
<p>Note that either the “data carrier” or “destination” voting architectures are possible using tokens.</p>
<h2 id="token-shuffle">Token Shuffle</h2>
<ul>
<li>Enables voter anonymity from the registration authority and the public</li>
<li>Participant can still validate their vote it is cast</li>
</ul>
<p>A token shuffle is CoinJoin<sup>2</sup>, CashShuffle<sup>3</sup>, or an equivalent algorithm applied to the tokens that confer permission to participate in a vote, rather than currency.</p>
<p>A coin join is a very simple concept so is described briefly here:</p>
<p>A transaction may consist of many inputs and many outputs.  Let us propose that many individuals contribute a single input of one token and receive a single output of one token (to a different address from their input) into a single transaction.  If the order of the inputs does not correspond to the order of the outputs, and the input and output quantities are all the same, it is impossible to determine which input corresponds to which output.  This process can be repeated with different partners to increase the pool of possible entities that may control a particular output.</p>
<p>The traditional coin shuffle suffers from a problem with varying input quantities:  Its possible to connect inputs to outputs if participants include different quantities because each participants’ quantity must be preserved.  However, this is not a problem for voting tokens since each participant has exactly 1.</p>
<p>Also note that actual construction of the multi-participant transaction may leak identity information or suffer denial-of-service attacks, so implementations are significantly more complex than this conceptual description.</p>
<h2 id="voting-topic-and-data-commitmentssup6sup">Voting Topic and Data Commitments<sup>6</sup></h2>
<ul>
<li>Ensures integrity of voter choices
<ul>
<li>Cannot omit a choice, add extra choices, or swap choices to identifiers for a subset of voters</li>
</ul>
</li>
<li>Prevents vote replay</li>
</ul>
<p>Apply a cryptographic hash to the complete voting information and choice data to create an identifier that probabilistically uniquely identifies the vote session.  Participants and network software can compare identifiers to ensure they have the correct data.  The larger network can reject unknown identifiers which might notify participants of misbehaving or malicious software.  Identifiers should be included in each participant’s vote so that the vote itself affirms its vote on a particular topic with the particular topic data.  This prevents both malicious topic data and replay attacks.</p>
<h2 id="fake-vote-commitments">Fake Vote Commitments</h2>
<ul>
<li>Increase anonymity</li>
<li>Plausible deniability (for a while) for  participants by handing out fakes
<ul>
<li>Hard to intimidate voters by threatening since participants can produce a fake vote.</li>
<li>This would make it hard for participants to sell their vote because participants who voted differently can provide a fake proof to get the money</li>
</ul>
</li>
<li>obfuscates ongoing counts</li>
</ul>
<p>The voting registration authority creates a number of fake votes and commits to those votes via a cryptographic hash.  The fakes are issued during the election process.  When the polls close, the fake votes are revealed and the cryptographic hash proves all the fakes.  Revealing partial fakes results in a non-matching hash so it is not possible to affect the election outcome via a partial reveal.</p>
<h2 id="vote-encryption">Vote Encryption</h2>
<ul>
<li>Votes are encrypted using a public/private keypair, which is revealed when all votes are cast</li>
<li>Key could be an aggregate</li>
<li>Problem: Entity controlling key reveal or last reveal of an aggregate key could choose not to reveal if they do not like the election results.</li>
</ul>
<p>Vote encryption would prevent miner blockchain attacks from denying votes for one candidate from entering the blockchain since the attacker cannot determine the contents of a vote until after the polls close and presumably the blockchain has advanced beyond the point which re-organization is affordable.</p>
<h2 id="zk-snarks">ZK-SNARKs</h2>
<p>TBD</p>
<h2 id="references">References</h2>
<p>[1]:  The Sybil Attack: <a href="https://www.microsoft.com/en-us/research/publication/the-sybil-attack/">https://www.microsoft.com/en-us/research/publication/the-sybil-attack/</a><br />
[2]: CoinJoin: <a href="https://bitcointalk.org/?topic=279249">https://bitcointalk.org/?topic=279249</a><br />
[3]: CoinShuffle:  <a href="https://www.darrentapp.com/pdfs/coinshuffle.pdf">https://www.darrentapp.com/pdfs/coinshuffle.pdf</a>,  <a href="https://github.com/cashshuffle/spec">https://github.com/cashshuffle/spec</a><br />
[5]: Commutative Merkle Trees: <a href="https://medium.com/@g.andrew.stone/tree-signature-variations-using-commutative-hash-trees-4a8a47d4f8ce">https://medium.com/@g.andrew.stone/tree-signature-variations-using-commutative-hash-trees-4a8a47d4f8ce</a><br />
[6]: TBD: Dagur &amp; Jorgen voting project &amp; paper</p>
